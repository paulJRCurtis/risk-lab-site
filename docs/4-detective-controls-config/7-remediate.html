<!doctype html><html class=no-js lang=en-us prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb#"><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta property="og:title" content="Risk & Compliance Labs"><meta property="og:type" content="website"><meta property="og:url" content><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=generator content="Hugo 0.80.0"><meta name=description content="Hands on labs for those interested in risk & assurance, and compliance."><meta name=author content="Amazon AWS"><link rel="shortcut icon" href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><link rel=icon href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><title>Auto Remediate :: Risk & Compliance Labs</title><link href=../css/nucleus.css rel=stylesheet><link href=../css/fontawesome-all.min.css rel=stylesheet><link href=../css/hybrid.css rel=stylesheet><link href=../css/featherlight.min.css rel=stylesheet><link href=../css/perfect-scrollbar.min.css rel=stylesheet><link href=../css/auto-complete.css rel=stylesheet><link href=../css/atom-one-dark-reasonable.css rel=stylesheet><link href=../css/theme.css rel=stylesheet><link href=../css/hugo-theme.css rel=stylesheet><link href=../css/theme-aws.css rel=stylesheet><script src=../js/jquery-3.3.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=../4-detective-controls-config/7-remediate.html><nav id=sidebar><div id=header-wrapper><div id=header><div><a href=../ title="Go home"><img style=vertical-align:middle src=../images/logo.png height=70px></a></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../js/lunr.min.js></script><script type=text/javascript src=../js/auto-complete.js></script><script type=text/javascript>var baseurl="";</script><script type=text/javascript src=../js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-start-workshop.html title="Start the Workshop" class=dd-item><a href=../1-start-workshop.html><b></b>Start the Workshop</a><ul><li data-nav-id=/1-start-workshop/on-your-own.html title="In your own account" class=dd-item><a href=../1-start-workshop/on-your-own.html><b></b>On your own</a><ul><li data-nav-id=/1-start-workshop/on-your-own/create-an-aws-account.html title="Create an AWS Account" class=dd-item><a href=../1-start-workshop/on-your-own/create-an-aws-account.html>Create an AWS Account</a></li></ul></li><li data-nav-id=/1-start-workshop/at-an-aws-event.html title="At an AWS Event" class=dd-item><a href=../1-start-workshop/at-an-aws-event.html>At an AWS Event</a><ul><li data-nav-id=/1-start-workshop/at-an-aws-event/aws-workshop-portal.html title="AWS Workshop Portal" class=dd-item><a href=../1-start-workshop/at-an-aws-event/aws-workshop-portal.html><b></b>AWS Workshop Portal</a></li></ul></li></ul></li><li data-nav-id=/2-know-the-console.html title="Getting to Know the Console" class=dd-item><a href=../2-know-the-console.html>Getting to Know the Console</a></li><li data-nav-id=/3-aws-compliance-reports.html title="Accessing AWS Compliance Reports" class=dd-item><a href=../3-aws-compliance-reports.html>AWS Compliance Reports</a><ul><li data-nav-id=/3-aws-compliance-reports/1-intro.html title=Introduction class=dd-item><a href=../3-aws-compliance-reports/1-intro.html><b>1. </b>Introduction</a></li><li data-nav-id=/3-aws-compliance-reports/2-access-a-report.html title="Access a report" class=dd-item><a href=../3-aws-compliance-reports/2-access-a-report.html><b>2. </b>Access a report</a></li><li data-nav-id=/3-aws-compliance-reports/3-interpret-results.html title="Interpreting the results" class=dd-item><a href=../3-aws-compliance-reports/3-interpret-results.html><b>3. </b>Interpreting the results</a></li><li data-nav-id=/3-aws-compliance-reports/4-shared-responsibility.html title="Deep Dive: Shared Responsibility" class=dd-item><a href=../3-aws-compliance-reports/4-shared-responsibility.html><b>4. </b>Deep Dive: Shared Responsibility</a></li></ul></li><li data-nav-id=/4-detective-controls-config.html title="Detective Controls with Config" class="dd-item
parent"><a href=../4-detective-controls-config.html>Detective Controls with Config</a><ul><li data-nav-id=/4-detective-controls-config/1-intro.html title=Introduction class=dd-item><a href=../4-detective-controls-config/1-intro.html><b>1. </b>Introduction</a></li><li data-nav-id=/4-detective-controls-config/2-env-setup.html title=Set-up class=dd-item><a href=../4-detective-controls-config/2-env-setup.html><b>2. </b>Set-up</a></li><li data-nav-id=/4-detective-controls-config/3-config-setup.html title="Enable AWS Config" class=dd-item><a href=../4-detective-controls-config/3-config-setup.html><b>3. </b>Enable AWS Config</a></li><li data-nav-id=/4-detective-controls-config/4-add-rules.html title="Add Managed Config Rules" class=dd-item><a href=../4-detective-controls-config/4-add-rules.html><b>4. </b>Add Managed Config Rules</a></li><li data-nav-id=/4-detective-controls-config/5-dashboard.html title="Review Dashboard" class=dd-item><a href=../4-detective-controls-config/5-dashboard.html><b>5. </b>Review Dashboard</a></li><li data-nav-id=/4-detective-controls-config/6-rule-scope.html title="Rule Scope" class=dd-item><a href=../4-detective-controls-config/6-rule-scope.html><b>6. </b>Rule Scope</a></li><li data-nav-id=/4-detective-controls-config/7-remediate.html title="Auto Remediate" class="dd-item
parent
active"><a href=../4-detective-controls-config/7-remediate.html><b>7. </b>Auto Remediate</a></li><li data-nav-id=/4-detective-controls-config/8-timelines.html title="Explore Timelines" class=dd-item><a href=../4-detective-controls-config/8-timelines.html><b>8. </b>Explore Timelines</a></li><li data-nav-id=/4-detective-controls-config/9-clean-up.html title="Clean up" class=dd-item><a href=../4-detective-controls-config/9-clean-up.html><b>9. </b>Clean up</a></li></ul></li><li data-nav-id=/6-patching-controls-ssm.html title="Patching Controls with Systems Manager" class=dd-item><a href=../6-patching-controls-ssm.html>Patching Controls with Systems Manager</a><ul><li data-nav-id=/6-patching-controls-ssm/1-intro.html title=Introduction class=dd-item><a href=../6-patching-controls-ssm/1-intro.html><b>1. </b>Introduction</a></li><li data-nav-id=/6-patching-controls-ssm/2-env-setup.html title=Set-up class=dd-item><a href=../6-patching-controls-ssm/2-env-setup.html><b>2. </b>Set-up</a></li><li data-nav-id=/6-patching-controls-ssm/3-current-os.html title="Determine the current OS versions" class=dd-item><a href=../6-patching-controls-ssm/3-current-os.html><b>3. </b>Determine the current OS versions</a></li><li data-nav-id=/6-patching-controls-ssm/4-set-patch-baselines.html title="Set patch baselines" class=dd-item><a href=../6-patching-controls-ssm/4-set-patch-baselines.html><b>4. </b>Set patch baselines</a></li><li data-nav-id=/6-patching-controls-ssm/5-review-compliance.html title="Review compliance" class=dd-item><a href=../6-patching-controls-ssm/5-review-compliance.html><b>5. </b>Review compliance</a></li><li data-nav-id=/6-patching-controls-ssm/6-maintenance-window.html title="Create a maintenance window" class=dd-item><a href=../6-patching-controls-ssm/6-maintenance-window.html><b>6. </b>Create a maintenance window</a></li><li data-nav-id=/6-patching-controls-ssm/7-patch-manager-config.html title="Create Patch Manager configuration" class=dd-item><a href=../6-patching-controls-ssm/7-patch-manager-config.html><b>7. </b>Create Patch Manager configuration</a></li><li data-nav-id=/6-patching-controls-ssm/8-patch-now.html title="Patch Now" class=dd-item><a href=../6-patching-controls-ssm/8-patch-now.html><b>8. </b>Patch Now</a></li><li data-nav-id=/6-patching-controls-ssm/9-clean-up.html title="Clean up" class=dd-item><a href=../6-patching-controls-ssm/9-clean-up.html><b>9. </b>Clean up</a></li></ul></li><li data-nav-id=/7-preventative-controls-codepipeline.html title="Preventative controls with Code Pipeline" class=dd-item><a href=../7-preventative-controls-codepipeline.html>Preventative controls with Code Pipeline</a><ul><li data-nav-id=/7-preventative-controls-codepipeline/1-intro.html title=Introduction class=dd-item><a href=../7-preventative-controls-codepipeline/1-intro.html><b>1. </b>Introduction</a></li><li data-nav-id=/7-preventative-controls-codepipeline/3-create-environments.html title="Create environments" class=dd-item><a href=../7-preventative-controls-codepipeline/3-create-environments.html><b>3. </b>Create environments</a></li><li data-nav-id=/7-preventative-controls-codepipeline/4-failed-step.html title="Identify failed resource" class=dd-item><a href=../7-preventative-controls-codepipeline/4-failed-step.html><b>3. </b>Identify failed resource</a></li><li data-nav-id=/7-preventative-controls-codepipeline/5-review-checks.html title="Review checks" class=dd-item><a href=../7-preventative-controls-codepipeline/5-review-checks.html><b>5. </b>Review checks</a></li><li data-nav-id=/7-preventative-controls-codepipeline/6-correct-cfn.html title="Review code pipeline" class=dd-item><a href=../7-preventative-controls-codepipeline/6-correct-cfn.html><b>6. </b>Review code pipeline</a></li><li data-nav-id=/7-preventative-controls-codepipeline/7-check-change.html title="Deploy change" class=dd-item><a href=../7-preventative-controls-codepipeline/7-check-change.html><b>7. </b>Deploy change</a></li><li data-nav-id=/7-preventative-controls-codepipeline/10-clean-up.html title="Clean up" class=dd-item><a href=../7-preventative-controls-codepipeline/10-clean-up.html><b>10. </b>Clean up</a></li></ul></li></ul><section id=footer><left><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | © 2020, Amazon Web Services, Inc. or its affiliates. All rights reserved.</left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=https://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fa fa-bars"></i></a></span><span class=links><a href=../>Risk & Compliance Workshop</a> > <a href=../4-detective-controls-config.html>Detective Controls with Config</a> > Auto Remediate</span></div></div></div><div id=body-inner><h1>Auto Remediate</h1><p>Now we will introduce an automated corrective remediation to the s3-bucket-server-side-encryption-enabled config rule. This means that AWS Config will automatically apply server side encryption to any bucket in the account found that doesn&rsquo;t have it turned on. This will move the rule from being detective to corrective. In a production environment you want to carefully choose the actions you automate and the resources that these actions apply to, but automation is a powerful way to move to a more proactive risk and controls management stance.</p><h4 id=1-get-the-automationassumerole-arn>1. Get the AutomationAssumeRole ARN</h4><p>To enable the auto remediation action you will need to provide Config with the permission to perform the auto remediation actions. The required role and permissions were created as part of the lab set-up but we need to apply them to the Manage Config Rule. To identify the Role we&rsquo;ll need the Role reference ID or <a href=https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html target=_blank>Amazon Resource Name (ARN)</a>. The ARN is used to uniquely identify the role.</p><p>To find the Role ARN go to <strong>Roles</strong> in <a href=https://aws.amazon.com/iam/ target=_blank>AWS Identity and Access Management</a> (IAM).</p><p>Use the <strong>Services</strong> dropdown to navigate to IAM and select <strong>Roles</strong>. From this screen you will see a list of existing roles and up the top you should see <strong>AutomationServiceRole</strong>.</p><figure><img src="../4-detective-controls-config/7-remediate/clue2-roles.png?classes=shadow&width=60pc" alt=AutomationServiceRole></figure><p>Click on the name of the role to see a summary of the role.
At the top of this screen you will see <strong>Role ARN</strong>. Copy the ARN (you can do so easily by clicking the copy icon to the right). This is the string you will need to paste into the AutomatedAssumeRole back in Config.</p><figure><img src="../4-detective-controls-config/7-remediate/clue2-role-summary.png?classes=shadow&width=60pc" alt="Role Summary"></figure><p>While you&rsquo;re here, you can see that the permissions of this role are defined by the policy &ldquo;ConfigAutoRemediationPolicy&rdquo;. Which makes sense given what we are tying to do. If you have time you gan dig in a bit deeper to see the exact permissions this policy grants.</p><h4 id=2-select-the-s3-bucket-server-side-encryption-enabled-rule>2. Select the s3-bucket-server-side-encryption-enabled rule</h4><p>Now that you have the Role ARN it&rsquo;s time to head back to AWS Config. From the AWS Config Console select <strong>Rules</strong> on the navigation menu on the left.</p><figure><img src="../4-detective-controls-config/7-remediate/clue3-config-rules.png?classes=shadow&width=60pc" alt="Config Rules"></figure><p>From here you will see the three rules you implemented, and that the <strong>Remediation action</strong> for each is &ldquo;Not set&rdquo;. Click on s3-bucket-server-side-encryption-enabled.</p><h4 id=3-configure-auto-remediation>3. Configure Auto remediation</h4><p>From the rules page, click on the <strong>Actions</strong> button at the top right, and select <strong>Manage remediation</strong>.</p><figure><img src="../4-detective-controls-config/7-remediate/clue3-bucket-encryption.png?classes=shadow&width=60pc" alt="Bucket Encryption"></figure><p>Complete the remediation section of the form as per below.</p><ul><li><p>Ensure <strong>Automatic remediation</strong> is selected.</p></li><li><p>Set <strong>Remediation action details</strong> to AWS-EnablesS3BucketEncryption.</p></li><li><p>The <strong>Resource ID Parameter</strong> must be set to BucketName. This tells Config that the Bucket Name will be variable.</p></li></ul><p>The three parameters are;</p><ul><li><strong>BucketName</strong> The name of the bucket to apply the auto remediation to. You will should see this is greyed out because you selected BucketName as the <strong>Resource ID Parameter</strong>. You do not want to specify a particular bucket because we want the remediation to be applied to all buckets.</li><li><strong>SSEAlgorithm</strong> The encryption algorithm, this must be set to AES256.</li><li><strong>AutoAssumeRole</strong> This is the role ARN that you copies in step 1. This allows the auto remediation to happen.</li></ul><figure><img src="../4-detective-controls-config/7-remediate/clue3-config-edit-remediation.png?classes=shadow&width=60pc" alt="Config Rule Edit Remediation"></figure><p>Click <span style="display:inline;font-weight:400;padding:5px 15px;color:#fff;border-style:solid;border-width:1px;background-color:#f90">Save changes</span></p><p>You will then be taken back to the Rules page where you will see the <strong>Remediation action</strong> has been set but the Rule is still showing noncompliant resource(s). It will take around 5-10 minutes for the remediation actions to run and for the config status to be refreshed. Move on to the next step and we&rsquo;ll come back and check later.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../4-detective-controls-config/6-rule-scope.html title="Rule Scope"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=../4-detective-controls-config/8-timelines.html title="Explore Timelines" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../js/clipboard.min.js></script><script src=../js/perfect-scrollbar.min.js></script><script src=../js/perfect-scrollbar.jquery.min.js></script><script src=../js/jquery.sticky.js></script><script src=../js/featherlight.min.js></script><script src=../js/html5shiv-printshiv.min.js></script><script src=../js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script src=../js/modernizr.custom-3.6.0.js></script><script src=../js/learn.js></script><script src=../js/hugo-learn.js></script><link href=../mermaid/mermaid.css rel=stylesheet><script src=../mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>